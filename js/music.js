var lyric=[{'content': "[00:00.00]成都[00:02.00]作曲：赵雷[00:04.00]编曲：赵雷,喜子[00:06.00]演唱：赵雷[00:08.00][00:14.00][00:18.27]让我掉下眼泪的 不止昨夜的酒[00:26.16]让我依依不舍的 不止你的温柔[00:33.82]余路还要走多久 你攥着我的手[00:41.77]让我感到为难的 是挣扎的自由[00:50.00][00:51.75]分别总是在九月 回忆是思念的愁[00:59.76]深秋嫩绿的垂柳 亲吻着我额头[01:07.52]在那座阴雨的小城里 我从未忘记你[01:15.47]成都 带不走的 只有你[01:22.79][01:23.60]和我在成都的街头走一走[01:32.13]直到所有的灯都熄灭了也不停留[01:40.02]你会挽着我的衣袖 我会把手揣进裤兜[01:47.77]走到玉林路的尽头 坐在小酒馆的门口[01:57.92][02:31.42]分别总是在九月 回忆是思念的愁[02:39.21]深秋嫩绿的垂柳 亲吻着我额头[02:47.09]在那座阴雨的小城里 我从未忘记你[02:55.02]成都 带不走的 只有你[03:01.77][03:03.09]和我在成都的街头走一走[03:11.42]直到所有的灯都熄灭了也不停留[03:19.38]你会挽着我的衣袖 我会把手揣进裤兜[03:27.19]走到玉林路的尽头 坐在小酒馆的门口[03:36.54][04:37.23][03:39.06]和我在成都的街头走一走[04:43.96][03:47.25]直到所有的灯都熄灭了也不停留[03:55.17]和我在成都的街头走一走[04:02.93]直到所有的灯都熄灭了也不停留[04:10.93]你会挽着我的衣袖 我会把手揣进裤兜[04:18.70]走到玉林路的尽头 走过小酒馆的门口[04:30.34][04:51.73]"},
    {'content':"[00:00.86][00:02.43]周杰伦[00:04.27]等你下课 (& 杨瑞代)[00:06.61][00:09.52]作词：周杰伦[00:11.56]作曲：周杰伦[00:13.70]LRC ：LOWLUXE[00:14.92][00:15.22]你住的巷子裡[00:18.43]我租了一间公寓[00:22.45]為了想与你不期而遇[00:28.17]高中三年 我為什麼[00:31.21]為什麼不好好读书[00:35.33]没考上跟妳一样的大学[00:40.26]我找了份工作[00:43.43]离你宿舍很近[00:46.66]当我开始学会做蛋饼[00:50.10]才发现你不吃早餐[00:54.75]喔 你又擦肩而过[00:59.73]你耳机听什麼[01:02.90]能不能告诉我[01:06.26][01:07.95]躺在你学校的操场看星空[01:14.10]教室裡的灯还亮着 你没走[01:20.35]记得我写给你的情书[01:26.87]都什麼年代了[01:30.26]到现在我还在写着[01:33.85]总有一天 总有一年 会发现[01:40.07]有人默默的[01:42.51]陪在你的身边[01:46.58]也许我不该在你的世界[01:52.85]当你收到情书 也代表我已经走远[02:01.38][02:24.82]学校旁的广场[02:28.07]我在这等鐘声响[02:32.11]等你下课 一起走好吗[02:37.83]弹着琴唱你爱的歌[02:41.03]暗恋一点都不痛苦[02:45.20]痛苦的是你根本没看我[02:50.04]我唱这麼走心[02:53.19]却走不进你心裡[02:56.51]在人来人往 找寻着你[02:59.64]守护着你 不求结局[03:04.47]喔 你又擦肩而过[03:09.48]我唱告白气球[03:12.54]终於你回了头[03:15.51][03:17.72]躺在你学校的操场看星空[03:23.84]教室裡的灯 还亮着 你没走[03:30.25]记得我写给你的情书[03:36.66]都什麼年代了[03:39.92]到现在我还在写着[03:43.43]总有一天 总有一年 会发现[03:49.75]有人默默的[03:52.13]陪在你的身边[03:56.19]也许我不该在你的世界[04:02.67]当你收到情书 也代表我已经走远[04:11.30][04:13.25]classying.blogspot.tw[04:14.99]YouTube LOW LUXE[04:17.81]"},
    {'content':"[00:00.00]周杰伦 - 告白气球[00:08.00]词：方文山[00:16.00]曲：周杰伦[00:22.90]塞纳河畔 左岸的咖啡[00:25.40]我手一杯 品尝你的美[00:28.43]留下唇印的嘴[00:32.95]花店玫瑰 名字写错谁[00:36.59]告白气球 风吹到对街[00:39.35]微笑在天上飞[00:44.11]你说你有点难追[00:46.35]想让我知难而退[00:48.62]礼物不需挑最贵[00:51.61]只要香榭的落叶[00:54.10]喔～营造浪漫的约会[00:57.12]不害怕搞砸一切[00:59.59]拥有你就拥有 全世界[01:04.85]亲爱的 爱上你 从那天起[01:11.10]甜蜜的很轻易[01:15.60]亲爱的 别任性 你的眼睛[01:21.60]在说我愿意[01:25.86][01:48.35]塞纳河畔 左岸的咖啡[01:50.60]我手一杯 品尝你的美[01:54.11]留下唇印的嘴[01:58.25]花店玫瑰 名字写错谁[02:01.59]告白气球 风吹到对[02:04.60]微笑在天上飞[02:09.06]你说你有点难追[02:11.60]想让我知难而退[02:14.35]礼物不需挑最贵[02:16.85]只要香榭的落叶[02:19.60]喔～营造浪漫的约会[02:22.35]不害怕搞砸一切[02:24.61]拥有你就拥有 全世界[02:30.11]亲爱的 爱上你 从那天起[02:36.60]甜蜜的很轻易[02:41.10]亲爱的 别任性 你的眼睛[02:47.11]在说我愿意[02:51.60]亲爱的 爱上你 恋爱日记[02:58.11]飘香水的回忆[03:01.57]一整瓶 的梦境 全都有你[03:08.11]搅拌在一起[03:12.61]亲爱的别任性 你的眼睛[03:20.61]在说我愿意"},
    {'content':"[00:00.00][00:00.73]安和桥 - 宋冬野[00:02.92]词曲编：宋冬野[00:15.42][00:38.37]让我再看你一遍从南到北[00:43.05][00:44.61]像是被五环路蒙住的双眼[00:50.99][00:52.80]请你再讲一遍关于那天[00:57.93][00:59.57]抱着盒子的姑娘和擦汗的男人[01:05.44][01:06.88]我知道那些夏天[01:10.25]就像青春一样回不来[01:14.00]代替梦想的也只能是勉为其难[01:20.32][01:21.57]我知道吹过的牛逼[01:24.70]也会随青春一笑了之[01:28.82]让我困在城市里纪念你[01:34.70][01:37.38]让我再尝一口秋天的酒[01:42.32][01:43.82]一直往南方开不会太久[01:49.70][01:51.88]让我再听一遍最美的那一句[01:57.57][01:58.55]你回家了我在等你呢[02:03.67][02:35.49]我知道那些夏天[02:38.86]就像青春一样回不来[02:42.61]代替梦想的也只能是勉为其难[02:49.24][02:50.05]我知道吹过的牛逼[02:53.30]也会随青春一笑了之[02:57.24]让我困在城市里 纪念你[03:04.31][03:05.12]我知道那些夏天[03:08.44]就像你一样回不来[03:12.25]我已不会再对谁满怀期待[03:18.25][03:19.56]我知道这个世界[03:23.18]每天都有太多遗憾[03:26.88]所以你好再见[03:32.39][03:33.76]"},
    {'content':"[00:00.00]纯音乐<br>请欣赏"},
    {'content':"[00:00.00][00:01.00]岁月神偷 - 金玟岐[00:06.00][00:07.50][00:12.50][00:17.50][00:19.04]能够握紧的就别放了[00:23.09]能够拥抱的就别拉扯[00:27.22]时间着急的 冲刷着[00:31.65]剩下了什么[00:35.18]原谅走过的那些曲折[00:39.14]原来留下的都是真的[00:43.22]纵然似梦啊 半醒着[00:47.35]笑着哭着都快活[00:51.69]谁让[00:54.73]时间是让人猝不及防的东西[00:58.95]晴时有风阴有时雨[01:02.95]争不过朝夕 又念着往昔[01:06.93]偷走了青丝却留住一个你[01:11.00]岁月是一场有去无回的旅行[01:15.01]好的坏的都是风景[01:18.98]别怪我贪心 只是不愿醒[01:22.98]因为你只为你愿和我一起[01:27.00]看云淡风轻[01:31.14][01:42.91]时间是让人猝不及防的东西[01:46.92]晴时有风阴有时雨[01:50.91]争不过朝夕 又念着往昔[01:54.92]偷走了青丝却留住一个你[01:58.89]岁月是一场有去无回的旅行[02:02.88]好的坏的都是风景[02:06.96]别怪我贪心 只是不愿醒[02:10.86]因为你只为你愿和我一起[02:16.32]看云淡风轻[02:20.07]"},
    {'content':"[00:00.00] 作曲 : MICHIRU•KEITA[00:01.00] 作词 : MAIKO[00:03.20]君はいま涙流した 泣きじゃくる子供のように<br>你正在哭泣  仿佛抽泣的孩童一般[00:08.83]たとえ明日が見えなくなっても守るよ<br>即便不见明日亦要守护[00:15.05]夏の空見上げて睨んだ<br>仰望夏日天空对天凝视[00:20.90][00:24.29]強がってばかりで 涙は見せない<br>逞强按捺着眼泪[00:30.08]本当は怖いくせに<br>明明如此害怕[00:36.16]大切なものを 失わぬように<br>为了不失去珍视之物[00:41.88]必死で走り抜けてきた<br>拼命奔走疾行[00:47.93]いつだって長い夜を ふたりで乗り越えた<br>总是两人一起撑过漫漫长夜[00:53.49]このまま一緒にいるから 強がってないでいいんだよ<br>如果总是有你陪伴 便不必继续逞强[01:01.38]君はいま涙流した 泣きじゃくる子供のように<br>你正在哭泣  仿佛抽泣的孩童一般[01:07.29]たとえ明日が見えなくなっても進むよ<br>即便不见明日亦要前行[01:13.27]夏の空見上げて叫んだ<br>仰望夏日天空对天呼喊[01:22.74]誰かがつぶやいた言葉のわなに<br>谁在怨念陷阱这话[01:28.48]踊るように惑わされて<br>想用舞蹈诱惑[01:34.26]大切なものは心の中に<br>心中的珍视之物[01:40.23]わかってた君なのに<br>明明知道即使是你[01:45.96]信じることが怖くて涙を忘れた<br>疑惑的相信 被遗忘的眼泪[01:51.82]風が背中を押した ふたりならきっと行けるよ<br>风在身后肆虐 要是两人一定要撑住[01:59.66]君の手を強く握った<br>紧紧牵着你的手[02:02.70]無邪気たる子供のように<br>好似天真无邪的孩子般[02:05.64]たとえ時間が現在を奪っても進むよ<br>即使被夺走时间也要继续前行[02:11.68]夏の空見指して走った<br>面朝夏日的天空奔跑[02:17.71]夏の空見指して走った<br>面朝夏日的天空奔跑[02:24.20]<br>[02:35.39]こんなにも広い世界で<br>如此辽阔的世界[02:37.62]独りになってゆくのだろう<br>只剩下我一个人去吧[02:40.48]溢れそうな想いを受け止めてあげるよ<br>承受不了给予的那么多思念[02:46.34]君はいま涙ながした 泣きじゃくる子供のように<br>你正在哭泣   仿佛抽泣的孩童一般[02:52.13]たとえ明日が見えなくなっても守よ<br>即便不见明日亦要守护[02:58.34]夏の空見上げて叫んだ<br>仰望夏日天空对天呼喊[03:04.25]夏の空見上げて睨んだ<br>仰望夏日天空对天呼喊"},
    {'content':"[00:00.00] 作曲 : 周杰伦[00:01.00] 作词 : 周杰伦[00:29.25]故事的小黄花[00:32.68]从出生那年就飘着[00:36.17]童年的荡秋千[00:39.67]随记忆一直晃到现在[00:42.74]rui sou sou xi dou xi la[00:45.83]sou la xi xi xi xi la xi la sou[00:49.87]吹着前奏望着天空[00:53.17]我想起花瓣试着掉落[00:56.71]为你翘课的那一天[00:58.85]花落的那一天[01:00.49]教室的那一间[01:02.29]我怎么看不见[01:04.18]消失的下雨天[01:05.71]我好想再淋一遍[01:10.05]没想到失去的勇气我还留着[01:15.83]好想再问一遍[01:17.82]你会等待还是离开[01:24.80]刮风这天我试过握着你手[01:30.38]但偏偏雨渐渐大到我看你不见[01:38.75]还要多久我才能在你身边[01:45.17]等到放晴的那天也许我会比较好一点[01:52.63]从前从前有个人爱你很久[01:58.26]但偏偏风渐渐把距离吹得好远[02:06.54]好不容易又能再多爱一天[02:13.21]但故事的最后你好像还是说了拜拜[02:22.29][02:34.96]为你翘课的那一天[02:36.80]花落的那一天[02:38.60]教室的那一间[02:40.34]我怎么看不见[02:42.08]消失的下雨天[02:43.98]我好想再淋一遍[02:47.91]没想到失去的勇气我还留着[02:54.39]好想再问一遍[02:55.95]你会等待还是离开[03:02.77]刮风这天我试过握着你手[03:08.20]但偏偏雨渐渐大到我看你不见[03:16.72]还要多久我才能在你身边[03:23.20]等到放晴的那天也许我会比较好一点[03:30.61]从前从前有个人爱你很久[03:36.74]偏偏风渐渐把距离吹得好远[03:44.59]好不容易又能再多爱一天[03:51.07]但故事的最后你好像还是说了拜拜[03:58.31]刮风这天我试过握着你手[04:02.06]但偏偏雨渐渐大到我看你不见[04:05.35]还要多久我才能够在你身边[04:08.93]等到放晴那天也许我会比较好一点[04:12.87]从前从前有个人爱你很久[04:15.81]但偏偏雨渐渐把距离吹得好远[04:19.25]好不容易又能再多爱一天[04:22.73]但故事的最后你好像还是说了吧"},
    {'content':"[00:00.00][00:00.23]绅士 - 薛之谦[00:07.54]词：薛之谦[00:10.71]曲：薛之谦[00:13.55][00:19.28]好久没见了什么角色呢[00:23.52]细心装扮着[00:25.31]白色衬衫的袖扣是你送的[00:31.98]尽量表现着像不在意的[00:36.17]频繁暴露了自欺欺人者[00:41.55]越掩饰越深刻[00:44.59]你说我说听说[00:47.87]忍着言不由衷的段落[00:52.16]我反正决定自己难过[00:58.73][01:01.50]我想摸你的头发[01:03.70]只是简单的试探啊[01:07.04][01:09.79]我想给你个拥抱[01:12.13]像以前一样可以吗[01:16.92]你退半步的动作认真的吗[01:21.58]小小的动作伤害还那么大[01:25.86]我只能扮演个绅士[01:29.05]才能和你说说话[01:33.13][01:34.83]我能送你回家吗[01:37.44]可能外面要下雨啦[01:40.63][01:43.51]我能给你个拥抱[01:45.75]像朋友一样可以吗[01:49.12][01:50.93]我忍不住从背后抱了一下[01:55.30]尺度掌握在不能说想你啊[01:59.29]你就当刚认识的绅士[02:02.88]闹了个笑话吧[02:07.95][02:21.36]尽量表现着善解人意的[02:25.62]频繁暴露了不欲人知的[02:31.18]越掩饰越深刻[02:34.13]想说听说别说[02:37.30]忍着言不由衷的段落[02:41.43]我反正注定留在角落[02:48.33][02:50.57]我想摸你的头发[02:53.23]只是简单的试探啊[02:59.00]我想给你个拥抱[03:01.62]像以前一样可以吗[03:05.32][03:06.74]你退半步的动作认真的吗[03:11.16]小小的动作伤害还那么大[03:15.28]我只能扮演个绅士[03:18.57]才能和你说说话[03:22.44][03:24.41]我能送你回家吗[03:26.95]可能外面要下雨啦[03:32.27]我能给你个拥抱[03:35.32]像朋友一样可以吗[03:38.94][03:40.39]我忍不住从背后抱了一下[03:44.87]尺度掌握在不能说想你啊[03:48.77]你就当刚认识的绅士[03:52.42]闹了个笑话吧[03:56.62][03:58.28]你能给我只左手[04:00.53]牵你到马路那头吗[04:04.18][04:06.09]我会像以前一样[04:09.00]看着来往的车子啊[04:14.19]我们的距离在眉间皱了下[04:18.73]迅速还原成路人的样子啊[04:22.98]越有礼貌我越害怕[04:26.06]绅士要放得下[04:30.41]"}
];
window.onload = function () {
    var audio = document.getElementById('audio'), // 音乐
        sourceList = audio.getElementsByTagName('source'), // 音乐列表
        play = document.getElementById('play'), // 播放按钮
        prev = document.getElementById('prev'), // 上一曲
        next = document.getElementById('next'), // 下一曲
        jingyin = document.getElementById('jingyin'), // 静音
        voiceBar = document.getElementById('voice-bar'), // 音量调节
        musicBar = document.getElementById('music-bar'), // 播放进度控制
        playedBar = document.getElementById('played-bar'), // 已播放进度条
        voicedBar = document.getElementById('voiced-bar'), // 已播放进度条
        musicTitle = document.getElementById('title'), // 音乐标题
        loadBar = document.getElementById('load-bar'), // 加载进度条
        currentTime = document.getElementById('current-time'), // 当前音乐时间
        totalTime = document.getElementById('total-time'), // 当前音乐时间
        musicImg = document.getElementById('music-img'), // 音乐封面
        xunhuan = document.getElementById('xunhuan'), // 循环按钮
        mlist=document.getElementById('oncl').getElementsByTagName('li'),
        micon=document.getElementById('oncl').getElementsByTagName('div'),
        needle=document.getElementById('needle'),
        listbtn=document.getElementById('listbtn'),
        musicList=document.getElementById('music-list'),
        phonelist=document.getElementById('gedan'),
        lyric_txt=document.getElementById("lyric_txt"),
        lyric_con=document.getElementById("lyric_con"),
        lyrichead=document.getElementById('lyrichead'),
        lyricbtn=document.getElementById('lyricbtn'),
        gecilist=document.getElementById('geci'),
        phonelyric=document.getElementById('lyric'),
        currentSrcIndex = 0,
        btnflag=0,
        lyricflag=1;
    // 网易云音乐模块
    var keyword = document.getElementById('keyword'); // 搜索歌名
    var searchBtn = document.getElementById('search-btn'); // 搜索按钮
    var result = document.getElementById('result'); // 结果区
    var toPlay = document.getElementById('to-play'); // 立即播放按钮

    // 是否循环播放
    audio.loop = false;

    // 是否自动播放
    audio.autoplay = false;

    // 初始化音量
    audio.volume = 0.5;
    var voicedBarWidth = (audio.volume / 1) * voiceBar.clientWidth;
    voicedBar.style.width = voicedBarWidth + 'px';

    // 是否自动缓冲加载
    audio.autobuffer = true;

    // 显示第一首歌曲时长
    (function () {
        var fen = parseInt(audio.duration / 60);
        var miao = parseInt(audio.duration % 60);
        if (miao < 10) {
            miao = '0'+miao;
        }
        totalTime.innerHTML = fen + ':' + miao;
        lyric_ctrl();
    })();
    function lyric_ctrl()
    {
        var lyricObj=lyric[currentSrcIndex].content;
        var temp=lyricObj.split("[");
        var html="";
        for(var i=0;i<temp.length;i++)
        {
            var arr=temp[i].split("]");
            var text=(arr[1]);
            var time=arr[0].split(",");
            var temp2=time[0].split(".");
            var ms=temp2[1];//毫秒
            var temp3=temp2[0].split(":");
            var s=temp3[1];//秒
            var m=temp3[0];//分
            var s_sum=parseInt(m*60)+parseInt(s);
            if(text)
            {
                html+="<p id='lyric"+s_sum+"'>"+text+"</p>"+"<br>";
            }
        }
        lyric_txt.innerHTML=html;
    }
    for (var i=0;i<mlist.length;i++){
        clickList(i);
    }
    //点击歌单播放歌曲
    function clickList(n){
        mlist[n].onclick=function(){
            currentSrcIndex=n;
            var currentSrc = sourceList[n].getAttribute('src');
            var currentImg = sourceList[n].getAttribute('data-img');
            musicImg.setAttribute('src', currentImg);
            audio.setAttribute('src', currentSrc);
            audio.play();
            play.innerHTML = '||';
            musicImg.style.animation = 'xuanzhuan 5s linear infinite';
            musicTime(n);
            rotaten();
            seticon(n);
            lyric_ctrl();
        }
    }
    phonelist.onclick=function(){
        musicList.style.display="inline";
        if(btnflag==0){
            musicList.style.left='0';
            musicList.style.opacity='1';
            btnflag=1;
        }
        else {
            musicList.style.left='-100%';
            musicList.style.opacity='0';
            btnflag=0;
        }
    };
    var changpian=document.getElementById('changpian'),
        geciflag=0;
    phonelyric.onclick=function(){
        if(geciflag==0){
            gecilist.style.display="inline-block";
            changpian.style.display="none";
            geciflag=1;
        }
        else {
            gecilist.style.display="none";
            changpian.style.display="inline-block";
            geciflag=0;
        }
    };
    var mL=document.getElementById('musiclist');
    //歌单隐藏/显示
    listbtn.onclick=function(){
        if(btnflag==0){
            musicList.style.left='-35%';
            musicList.style.opacity='0';
            btnflag=1;
        }
        else {
            musicList.style.left='6%';
            musicList.style.opacity='1';
            btnflag=0;
        }
    };
    lyricbtn.onclick=function(){
        if(lyricflag==0){
            gecilist.style.opacity='1';
            lyricflag=1;
        }
        else {
            gecilist.style.opacity='0';
            lyricflag=0;
        }
    };
    //设置正在播放效果
    function seticon(n){
        for(var i=0;i<micon.length;i++){
            if(n!==i){
                micon[i].className="";
            }
        }
        if(audio.paused){
            micon[n].className="jicon";}
        else {
            micon[n].className="micon";
        }
    }
    //指针移动
    function rotaten(){
        if(audio.paused){
            needle.style.transform="rotate(-25deg)";
        }
        else {
            needle.style.transform="rotate(0deg)";
        }
    }
    // 播放 暂停
    play.onclick = function () {
        if (audio.paused) {
            audio.play();
            this.innerHTML = '||';
            musicImg.style.animation = 'xuanzhuan 5s linear infinite';
            rotaten();
            seticon(currentSrcIndex);
        } else {
            audio.pause();
            this.innerHTML = '►';
            musicImg.removeAttribute('style');
            rotaten();
            seticon(currentSrcIndex);
        }
        musicTime(currentSrcIndex);
    };
    // 下一曲
    next.onclick = function () {
        changeMusic('next');
        rotaten();
        seticon(currentSrcIndex);
        lyric_ctrl();
    };
    // 上一曲
    prev.onclick = function () {
        changeMusic('prev');
        rotaten();
        seticon(currentSrcIndex);
        lyric_ctrl();
    };
    // 切换歌曲
    function changeMusic (direct) {
        if (direct === 'next') {
            ++ currentSrcIndex > sourceList.length - 1 && (currentSrcIndex = 0); // 下一曲
        } else {
            -- currentSrcIndex < 0 && (currentSrcIndex = sourceList.length -1); // 上一曲
        }
        currentSrc = sourceList[currentSrcIndex].getAttribute('src');
        currentImg = sourceList[currentSrcIndex].getAttribute('data-img');
        musicImg.setAttribute('src', currentImg);
        audio.setAttribute('src', currentSrc);
        audio.play();
        play.innerHTML = '||';
        musicImg.style.animation = 'xuanzhuan 5s linear infinite';
        musicTime(currentSrcIndex);
    }
    // 音量调节（增加黄色现在音量显示）
    voiceBar.onclick = function (event) {
        var voiceBarWidth = voiceBar.clientWidth;
        var newVolume = (event.offsetX / voiceBarWidth);
        audio.volume = newVolume;

        // 音量大小更新
        var voicedBarWidth = (audio.volume / 1) * voiceBarWidth;
        voicedBar.style.width = voicedBarWidth + 'px';
    };
    // 播放进度控制
    musicBar.onclick = function (event) {
        var musicBarWidth = musicBar.clientWidth;
        var newCurrentTime = (event.offsetX / musicBarWidth) * audio.duration;
        audio.currentTime = newCurrentTime;
        var playedBarWidth = (audio.currentTime / audio.duration) * musicBarWidth;
        playedBar.style.width = playedBarWidth + 'px';
    };
    // 播放进度实时更新(修改为歌曲播放时开启定时器，暂停和页面load时清除定时器)
    function movelyric(){
        var id_num=parseInt(audio.currentTime);
        var lyric_p=document.getElementsByTagName("p");
        for(var i=0;i<lyric_p.length;i++)
        {
            lyric_p[i].index=i;
        }
        if(document.getElementById("lyric"+id_num))
        {
            var obj=document.getElementById("lyric"+id_num);
            for(var i=0;i<obj.index;i++)
            {
                lyric_p[i].className="played";
            }
            for(var j=obj.index;j<lyric_p.length;j++)
            {
                lyric_p[j].className="";
            }
            obj.className="yellow active";
            lyric_txt.style.top=lyric_con.offsetHeight/3-obj.offsetTop+"px";
        }
    }
    setInterval(function (){
        movelyric();
        var musicBarWidth = musicBar.clientWidth;
        var playedBarWidth = (audio.currentTime / audio.duration) * musicBarWidth;
        playedBar.style.width = playedBarWidth + 'px';
        if (audio.currentTime % 60 < 10) {
            currentTime.innerHTML = parseInt(audio.currentTime / 60) + ':0' + parseInt(audio.currentTime % 60);
        } else {
            currentTime.innerHTML = parseInt(audio.currentTime / 60) + ':' + parseInt(audio.currentTime % 60);
        }
        //如果是时间结束，并且是非单曲循环，自动下一曲
        if (audio.currentTime === audio.duration && !audio.loop) {
            next.onclick();
        }
    }, 100);
    // 静音
    jingyin.onclick = function () {
        if (!audio.muted) {
            audio.muted = true;
            voicedBar.style.width = 0 +'px';
        }else {
            audio.muted = false;
            var voiceBarWidth = voiceBar.clientWidth;
            // 音量大小更新
            var voicedBarWidth = (audio.volume / 1) * voiceBarWidth;
            voicedBar.style.width = voicedBarWidth + 'px';
        }
    };

    // 判断文件缓冲进度
    setInterval(function updateCache () {
        var buffered, percent;
        // 已缓冲部分
        audio.readyState == 4 && (buffered = audio.buffered.end(0));
        // 已缓冲百分百
        audio.readyState == 4 && (percent = Math.round(buffered / audio.duration * 100) + '%');
        loadBar.style.width = (Math.round(buffered / audio.duration * 100) * musicBar.clientWidth * 0.01) + 'px';
    }, 1000);
    // 计算音乐时间
    function musicTime(k) {
        // 更换播放歌曲
        musicTitle.innerHTML = sourceList[k].title;
        lyrichead.innerHTML = sourceList[k].title;
        // 播放时间显示
        audio.addEventListener("canplay", function(){
            var sc=audio.duration;
            var fen = parseInt(sc / 60);
            var miao = parseInt(sc % 60);
            if (miao < 10) {
                totalTime.innerHTML = fen + ':0' + miao;
            }else {
                totalTime.innerHTML = fen + ':' + miao;
            }
        });
    }

    // 是否单曲循环
    xunhuan.onclick = function () {
        if (audio.loop) {
            audio.loop = false;
            this.innerHTML = '循环';
        } else {
            audio.loop = true;
            this.innerHTML = '单曲';
        }
    };

    var toPlay = document.getElementById('to-play'); // 立即播放按钮
    var result = document.getElementById('result'); // 结果区

    // 利用委托来为立即播放绑定事件
    result.addEventListener('click', function (ev) {
        var t = ev.target || ev.srcElement;
        if (t.tagName === 'A') {
            var oMusicSrc = result.getAttribute('data-audio');
            var oMusicImg = result.getAttribute('data-img');
            var oMusicName = result.getAttribute('data-music');
            var oSinger = result.getAttribute('data-singer');
            musicImg.setAttribute('src',oMusicImg);
            musicTitle.innerHTML = oMusicName + '-' + oSinger;
            audio.setAttribute('src', oMusicSrc);
            audio.play();
            play.innerHTML = '||';
            musicImg.style.animation = 'xuanzhuan 5s linear infinite';
        }

    });

    // 搜索按钮
    searchBtn.addEventListener('click', function () {
        var value = keyword.value;
        if (!value) {
            alert('关键词不能为空');
            return;
        }
        var url = "http://s.music.163.com/search/get/";
        var data = {
            "type": 1,
            "limit": 1,
            "s": value,
            "callback": "jsonpcallback"
        };
        var buffer = [];
        for (var key in data) {
            buffer.push(key + '=' + encodeURIComponent(data[key]));
        }
        var fullpath = url + '?' + buffer.join('&');
        CreateScript(fullpath);
    });

    function CreateScript (src) {
        var el = document.createElement('script');
        el.src = src;
        el.async = true;
        el.defer = true;
        document.body.appendChild(el);
    }
};
